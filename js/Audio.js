TM.Audio = (function() {
  var r = TM.Utils.rand;

  var settings = {
    menu : {
      max : 1,
      data : []
    },

    earth : {
      max : 5,
      data : []
    },

    water : {
      max : 5,
      data : []
    },

    air : {
      max : 5,
      data : []
    },

    fire : {
      max : 5,
      data : [
        [3,,0.2477,0.4477,0.34,0.223,,-0.2666,,,,,,,,,,,1,,,,,0.5],
        [3,,0.2775,0.4233,0.34,0.1967,,-0.2666,0.016,0.0428,0.0046,-0.008,0.036,0.0466,0.0437,,,,1,0.0259,0.0275,,0.0438,0.5],
        [3,0.0094,0.2639,0.4025,0.2936,0.1967,,-0.2666,0.016,0.036,0.0046,0.0412,0.036,0.0138,0.0437,0.0157,0.0316,0.0098,1,-0.0122,0.0275,0.0136,0.0438,0.5]
      ]
    },

    lasher : {
      max : 5,
      data : []
    },

    tribble : {
      max : 5,
      data : [
        [2,,0.2955,,0.2201,0.7765,0.2,-0.2174,,0.71,0.56,,,0.6593,-0.5655,,,,1,,,,,0.5],
        [2,0.0316,0.2639,,0.2335,0.7329,0.2448,-0.1911,0.0431,0.71,0.56,,,0.6365,-0.5317,,-0.041,0.015,0.9064,,0.0212,0.0362,-0.0408,0.5],
        [2,,0.2639,0.0468,0.2055,0.75,0.23,-0.2144,0.0271,0.7133,0.5312,0.0172,0.0398,0.6983,-0.5749,,-0.0399,-0.0463,0.925,-0.0061,,,-0.0515,0.5]
      ]
    },

    stun : {
      max : 5,
      data : [
        [0,,0.09,0.5889,0.484,0.54,,-0.02,,0.16,0.34,0.5637,0.6915,,,,,,1,,,,,0.5],
        [0,0.0163,0.0662,0.5889,0.4715,0.5425,,0.0074,-0.0352,0.1286,0.3746,0.5963,0.7198,0.0175,-0.0681,,0.0412,0.0432,0.9761,0.0387,0.0472,,,0.5],
        [0,0.0163,0.0748,0.6159,0.4715,0.5425,0.0309,0.0074,-0.0352,0.1005,0.3746,0.5536,0.7198,0.0175,-0.1115,,0.0412,-0.0061,0.9761,0.0761,0.0442,,0.0083,0.5]
      ]
    },

    thud : {
      max : 5,
      data : [
        [3,0.0122,0.1754,0.0444,0.183,0.438,0.0156,-0.492,0.0906,,0.03,0.0314,0.1224,0.0381,0.053,0.083,0.1109,-0.0124,1,0.1502,0.1029,0.167,-0.1358,0.5],
        [3,0.0089,0.1754,0.0217,0.183,0.393,0.0156,-0.492,0.1249,0.0375,0.0481,0.0314,0.1224,0.0381,0.053,0.083,0.1109,-0.0616,1,0.1078,0.1308,0.167,-0.1077,0.5],
        [3,0.0089,0.1765,0.0217,0.1374,0.3668,,-0.492,0.1249,0.0124,0.026,0.0314,0.1224,0.0381,0.0694,0.0444,0.0808,-0.0248,1,0.1568,0.1308,0.167,-0.1567,0.5]
      ]
    }
  };

  function Sound(settings) {
    var _this = this, sound;

    this.max = settings.max;
    this.tick = 0;
    this.pool = [];

    settings.data.forEach(function(item, index) {
      sound = new Audio();
      sound.src = jsfxr(item);
      sound.loop = settings.loop || false;
      _this.pool.push(sound);
    });
  }

  var _Audio = {
    sounds : {},

    init : function() {
      var i;

      for (i in settings) {
        if (settings.hasOwnProperty(i)) {
          this.sounds[i] = new Sound(settings[i]);
        }
      }
    },

    play : function(sound) {
      var sound = this.sounds[sound],
          data = sound.pool[(sound.pool.length > 1) ? r(0, sound.pool.length - 1) : 0];

      data.play();
      sound.tick = (sound.tick < sound.max - 1) ? sound.tick + 1 : 0;
    }
  };

  return _Audio;

})();
