TM.Audio = (function() {
  var r = TM.Utils.rand;

  var settings = {
    earth : {
      max : 3,
      data : [
        [3,0.14,0.35,0.18,0.62,0.12,,,0.3,0.49,,-0.4599,,,-0.7,0.1839,-0.48,-0.7576,0.22,0.34,0.48,0.56,0.04,0.5],
        [3,0.0949,0.35,0.1341,0.62,0.12,,0.0376,0.2725,0.49,,-0.4599,,,-0.718,0.2027,-0.48,-0.7378,0.2425,0.3196,0.48,0.576,-0.0031,0.5],
        [3,0.1769,0.343,0.1709,0.62,0.1115,,,0.2584,0.4906,,-0.4599,,,-0.7,0.1839,-0.48,-0.7783,0.22,0.34,0.4698,0.56,0.04,0.5]
      ]
    },

    water : {
      max : 3,
      data : [
        [2,0.11,0.38,0.25,0.87,0.3,,0.0397,0.6799,0.0495,0.0062,0.6,0.0332,,0.56,0.2,-0.06,0.6,0.87,-0.4399,0.17,0.14,-0.6,0.5]
      ]
    },

    air : {
      max : 3,
      data : [
        [3,0.2,0.0505,0.1809,0.5,0.41,,-0.0108,0.002,-0.0133,,0.2719,0.509,0.9626,-0.0969,-0.5361,0.0753,0.1552,0.9993,-0.0002,0.6453,,0.2999,0.5],
        [3,0.2338,0.0845,0.1809,0.4905,0.41,0.0432,-0.0108,0.002,,,0.2719,0.5341,0.9626,-0.1337,,0.0767,0.1471,1,0.0158,0.6712,,0.307,0.5],
        [3,0.2338,0.1027,0.1891,0.4905,0.4505,0.0432,-0.0108,0.002,0.0486,,0.2719,0.5341,0.9626,-0.1337,,0.0767,0.1471,1,0.0136,0.6712,,0.307,0.5]
      ]
    },

    fire : {
      max : 3,
      data : [
        [3,,0.2477,0.4477,0.34,0.223,,-0.2666,,,,,,,,,,,1,,,,,0.5],
        [3,,0.2775,0.4233,0.34,0.1967,,-0.2666,0.016,0.0428,0.0046,-0.008,0.036,0.0466,0.0437,,,,1,0.0259,0.0275,,0.0438,0.5],
        [3,0.0094,0.2639,0.4025,0.2936,0.1967,,-0.2666,0.016,0.036,0.0046,0.0412,0.036,0.0138,0.0437,0.0157,0.0316,0.0098,1,-0.0122,0.0275,0.0136,0.0438,0.5]
      ]
    },

    lasher : {
      max : 3,
      data : [
        [1,0.0331,0.2341,0.3025,0.293,0.5057,,0.3536,-0.6702,,,-0.6175,,,-0.047,0.5549,0.0015,0.3833,0.285,,-0.6082,0.0111,0.2431,0.5],
        [1,0.0331,0.2775,0.3453,0.293,0.5057,0.0224,0.3536,-0.6874,,,-0.6175,0.0299,,-0.085,0.5638,0.0232,0.3833,0.285,0.0174,,0.0111,0.2431,0.5],
        [1,0.082,0.2775,0.3453,0.3013,0.4728,0.0341,0.3559,-0.6874,0.0457,,-0.6386,,,-0.085,0.531,-0.0191,0.366,0.285,-0.0192,,0.0111,0.2431,0.5]
      ]
    },

    imp : {
      max : 3,
      data : []
    },

    banshee : {
      max : 3,
      data : [
        [0,0.4,0.01,0.02,0.2699,0.5604,,0.1673,,,,,,0.2157,0.02,0.72,-0.0799,-0.86,0.9174,,,,,0.5],
        [0,0.4,0.01,0.02,0.2699,0.57,,0.1673,,,,,,0.2157,0.02,0.72,-0.0799,-0.86,0.9174,,,,,0.5],
        [0,0.3944,0.0377,0.0374,0.2794,0.5931,0.0538,0.1529,-0.1129,0.0011,0.0275,0.005,0.0877,0.0931,0.0255,0.7317,-0.0703,-0.808,0.8573,0.0134,,,0.0198,0.5]
      ]
    },

    frostgiant : {
      max : 3,
      data : [
        [2,,0.049,0.2173,0.5542,0.5711,,-0.1999,-0.0045,0.0213,0.7235,-0.0938,0.2236,,0.4777,0.867,0.1158,0.7062,0.7015,0.2018,0.4116,0.0692,0.0036,0.5],
        [2,0.0284,0.0309,0.2935,0.5623,0.5603,,-0.154,0.0508,,0.7942,-0.0301,0.3098,0.0422,0.521,0.9642,0.06,0.622,0.7986,0.106,0.4364,0.0403,0.1043,0.5],
        [2,0.0614,0.0401,0.2523,0.5512,0.5582,0.0458,-0.15,0.0842,0.047,0.7704,-0.0368,0.3098,0.0674,0.499,0.9237,0.103,0.6395,0.7774,0.0818,0.434,0.109,0.1455,0.5]
      ]
    },

    stun : {
      max : 3,
      data : [
        [0,,0.09,0.5889,0.484,0.54,,-0.02,,0.16,0.34,0.5637,0.6915,,,,,,1,,,,,0.5],
        [0,0.0163,0.0662,0.5889,0.4715,0.5425,,0.0074,-0.0352,0.1286,0.3746,0.5963,0.7198,0.0175,-0.0681,,0.0412,0.0432,0.9761,0.0387,0.0472,,,0.5],
        [0,0.0163,0.0748,0.6159,0.4715,0.5425,0.0309,0.0074,-0.0352,0.1005,0.3746,0.5536,0.7198,0.0175,-0.1115,,0.0412,-0.0061,0.9761,0.0761,0.0442,,0.0083,0.5]
      ]
    },

    thud : {
      max : 3,
      data : [
        [3,0.0122,0.1754,0.0444,0.183,0.438,0.0156,-0.492,0.0906,,0.03,0.0314,0.1224,0.0381,0.053,0.083,0.1109,-0.0124,1,0.1502,0.1029,0.167,-0.1358,0.5],
        [3,0.0089,0.1754,0.0217,0.183,0.393,0.0156,-0.492,0.1249,0.0375,0.0481,0.0314,0.1224,0.0381,0.053,0.083,0.1109,-0.0616,1,0.1078,0.1308,0.167,-0.1077,0.5],
        [3,0.0089,0.1765,0.0217,0.1374,0.3668,,-0.492,0.1249,0.0124,0.026,0.0314,0.1224,0.0381,0.0694,0.0444,0.0808,-0.0248,1,0.1568,0.1308,0.167,-0.1567,0.5]
      ]
    },

    walk : {
      max : 3,
      data : [
        [2,,0.06,,0.1867,0.26,0.0399,-0.567,,,0.0174,-0.6,0.0435,0.4974,-0.0416,,0.0411,0.0146,1,-0.0205,,0.2186,0.073,0.5],
        [2,,0.5231,0.2056,0.9019,0.264,,-0.6485,,0.0732,0.7339,0.8908,-0.7222,0.9728,-0.4364,,-0.5954,0.1079,0.9147,,0.22,,0.4332,0.5],
        [2,0.12,0.1,0.11,0.9019,0.77,,-0.6485,,0.0732,0.7339,0.8908,-0.7222,0.9728,-0.4364,,-0.5954,0.1079,0.9147,,0.22,,0.4332,0.5]
      ]
    },

    menu : {
      max : 1,
      data : []
    }
  };

  function Sound(settings) {
    var _this = this, sound;

    this.max = settings.max;
    this.tick = 0;
    this.pool = [];

    settings.data.forEach(function(item, index) {
      sound = new Audio();
      sound.src = jsfxr(item);
      sound.loop = settings.loop || false;
      _this.pool.push(sound);
    });
  }

  var _Audio = {
    sounds : {},

    init : function() {
      var i;

      for (i in settings) {
        if (settings.hasOwnProperty(i)) {
          this.sounds[i] = new Sound(settings[i]);
        }
      }
    },

    play : function(sound) {
      var sound = this.sounds[sound],
          data = sound.pool[(sound.pool.length > 1) ? r(0, sound.pool.length - 1) : 0];

      if (data) data.play();
      sound.tick = (sound.tick < sound.max - 1) ? sound.tick + 1 : 0;
    }
  };

  return _Audio;

})();
